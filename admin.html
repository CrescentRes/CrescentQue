<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Queue Admin</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Password Protection Modal -->
    <div
      id="passwordModal"
      class="modal fade show d-block"
      tabindex="-1"
      data-bs-backdrop="static"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Admin Login</h5>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="adminPassword" class="form-label">Password:</label>
              <input
                type="password"
                class="form-control"
                id="adminPassword"
                placeholder="Enter password"
              />
              <div id="passwordError" class="text-danger mt-2 d-none">
                Incorrect password
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button id="loginBtn" class="btn btn-primary">Enter</button>
          </div>
        </div>
      </div>
    </div>

    <style>
      /* Make sure modal appears on top */
      .modal.show {
        background: rgba(0, 0, 0, 0.5);
      }

      /* Hide main content initially */
      .container.main-content {
        display: none;
      }
    </style>

    <div class="container main-content"></div>

    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-10">
          <div class="card mt-5">
            <div class="card-header bg-danger text-white">
              <h2 class="text-center">Queue Admin Dashboard</h2>
            </div>
            <div class="card-body">
              <div class="d-flex justify-content-between mb-3">
                <h4>Current Queue</h4>
                <div>
                  <button id="refreshBtn" class="btn btn-sm btn-primary me-2">
                    Refresh
                  </button>
                  <span class="badge bg-primary"
                    >Total: <span id="totalCount">0</span></span
                  >
                </div>
              </div>
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>Queue #</th>
                      <th>Name</th>
                      <th>Party Size</th>
                      <th>Waiting Time</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="queueTable">
                    <!-- Queue items will be inserted here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      id="firebase-debug"
      class="alert alert-info position-fixed bottom-0 end-0 m-3 d-none"
    ></div>
  </div>
  

    <script>
      // Add this right after Firebase initialization
      window.addEventListener("load", () => {
        const debugEl = document.getElementById("firebase-debug");

        // Test Firestore connection
        db.collection("queue")
          .limit(1)
          .get()
          .then((snap) => {
            debugEl.innerHTML = `Firestore connected. ${snap.size} documents found.`;
          })
          .catch((err) => {
            debugEl.innerHTML = `Firestore error: ${err.message}`;
            debugEl.classList.add("alert-danger");
          });
      });
    </script>

    <!-- Firebase scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="admin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
